name: Weekly Metrics

on:
  push:

jobs:
  count:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Get tag count
      run: |
        echo Hello
        git fetch
        start_date=$(date "+%Y%m%d" -d '1 week ago')
        echo $start_date
        end_date=$(date "+%Y%m%d" -d '1 days ago')
        echo $end_date
        git tag --sort=-taggerdate --format '%(taggerdate:format:%Y%m%d)' | awk '$1<=$end_date && $1>=$start_date'
        git tag --sort=-taggerdate --format '%(taggerdate:format:%Y%m%d)' | awk '$1<=20200406 && $1>=20200119' | wc -l
